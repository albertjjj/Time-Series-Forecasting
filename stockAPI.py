# key = 

data = "7179.95,7174.74,6955.48,7291.21,7337.63,7347.43,7713.86,8039.60,8067.60,7808.70,8087.45,8078.99,8149.31,8116.96,8735.14,8843.67,8711.63,8925.29,8939.86,8638.18,8652.68,8708.7,8635.07,8384.08,8451.23,8347.5,8562.3,8881.96,9131.11,9320.97,9545.07,9388.88,9363.19,9385.26,9269.70,9177.89,9625.45,9681.37,9795.34,9927.77,10132.7,9838.90,10236.63,10364.92,10218.09,10367.52,9926.3,9876.23,9636.62,10189.99,9701.03,9631.48,9670.85,9689.08,9919.55,9640.46,9392.86,8787.97,8784.99,8778.47,8639.59,8548.94,8923.04,8791.11,8756.96,9078.57,9126.63,8925.21,8166.31,7875.75,7959.22,7955.30,5800.20,5672.68,5304.1,5355.18,4944.70,5465.5,5363.82,6301.06,6185.27,6187.05,5884.34,6455.45,6784.31,6706.98,6721.49,6682.78,6229.48,5922.48,6483.73,6446.42,6537.33,6850.55,6776.3,6855.93,6805.36,7278.24,7175.66,7367.29,7321.81,6866.39,6873.8,7043.43,6889.86,6887.5,6718.79,7166.58,7065.08,7277.14,7185.,6856.14,6904.47,7118.38,7562.03,7497.86,7542.30,7624.85,7776.50,7761.75,8773.10,8767.67,8853.77,8963.0,8904.7,8887.50,8978.28,9371.68,9900.6,9917.24,9617.51,8786.6,8608.1,8815.23,9330.9,9757.29,9362.63,9418.91,9684.70,9723.68,9719.48,9540.88,9141.1,9192.84,9220.07,9048.71,8905.78,8835.72,9112.97,9507.52,9425.28,9688.3,9427.67,10268.58,9516.13,9667.06,9811.3,9659.66,9677.05,9737.4,9791.92,9786.14,9874.9,9260.83,9464.22,9458.65,9351.95,9441.76,9510.66,9457.62,9398.64,9279.76,9353.07,9289.1,9680.94,9609.68,9311.13,9252.63,9171.73,9022.15,9101.85,9188.06,9148.44,9236.31,9097.79,9094.32,9124.6,9055.46,9278.80,9244.41,9471.75,9236.14,9243.17,9229.,9286.7,9238.99,9260.47,9211.02,9133.77,9160.41,9176.68,9190.27,9172.58,9395.06,9530.79,9617.37,9568.97,9708.94,9938.95,11187.77,10939.67,11284.45,11118.9,11373.31,11766.74,11139.09,11261.80,11228.02,11653.40,11796.81,11639.93,11744.91,11673.12,11832.22,11340.58,11549.54,11752.16,11783.28,11895.62,11896.94,12399.11,12071.7,11749.82,11833.89,11583.13,11674.62,11666.41,11744.01,11378.72,11458.82,11302.12,11482.22,11515.04,11657.00,11678.37,11964.20,11427.70,10712.92,10563.8,10042.85,10207.60,10381.77,10043.19,10268.4,10341.01,10380.53,10436.36,10313.,10680.29,10829.50,11033.38,10937.11,10933.93,11048.87,10852.91,10526.20,10531.16,10260.03,10672.9,10729.06,10741.47,10752.34,10863.06,10764.28,10741.57,10626.60,10567.3,10555.02,10660.61,10756.40,10589.62,10645.75,10897.59,11052.39,11360.85,11334.02,11666.21,11443.73,11395.,11504.54,11355.16,11358.70,11471.0,11776.59,11936.36,13102.93,13140.6,12933.82,13081.67,13008.45,13033.52,13721.28,13282.26,13467.73,13573.71,13891.21,13730.19,13633.69,13832.93,14163.97,15424.5,15540.59,14783.98,15500.33,15283.78,15374.04,15820.49,16253.31,16347.04,15991.8,15918.08,16752.00,17593.48,17834.63,17954.85,18612.8,18591.85,18629.9,18469.20,19045.73,18746.93,17187.40,17023.96,17814.78,18114.41,19382.36,18980.97,19184.89,19464.53,18813.12,19045.02,19113.93,19107.59,18682.45,18543.00,18359.47,18137.31,18882.26,19060.27,19251.22,19443.47,21310.65,22895.97,23008.77,23890.82,23537.36,23177.27,23433.98,23224.45,23623.88,24581.00,26381.29,26389.29,26718.02,26975.72,28768.83"

from polygon import RESTClient
from time import sleep

key = ""

with RESTClient(key) as client:
    array = []
    #make string date in correct format
    year = "2020-"
    for i in range (1, 13):
        if i >9:
            month = year + str(i) + "-"
        else:
            month = year + "0" + str(i) + "-"
        for j in range (1, 32):
            if j > 9:
                date = month + str(j)
            else:
                date = month + "0" + str(j)
            #print(date)
            #use date to make request to polygon and add it to the array
            try:
                resp = client.crypto_daily_open_close("BTC", "USD", date)
                array.append(resp.close)
            except Exception as e:
                print("Error")
                print(e)
                continue
            sleep(12.5)
        
    print(array)
    resp = client.crypto_daily_open_close("BTC", "USD", "2020-01-31")
    print(resp.close)
    


